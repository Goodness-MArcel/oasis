<!DOCTYPE html>
<html lang="en">
  <%- include('../partials/head') %>
  <body class="admin-layout bg-light">
    <!-- Mobile topbar with hamburger (visible on small screens) -->
    <div class="mobile-topbar d-lg-none bg-white border-bottom py-2 px-3">
      <button id="navToggle" class="btn btn-outline-secondary btn-sm">
        <i class="fa-solid fa-bars"></i>
      </button>
    </div>
    <!-- Overlay element used when mobile menu is open -->
    <div id="mobileMenuOverlay" class="mobile-menu-overlay"></div>

    <div class="admin-shell">
      <aside id="mobileMenu" class="admin-sidebar" hidden>
        <nav class="admin-sidebar-nav nav me flex-column mb-auto m-0 small">
          <div
            class="admin-sidebar-header d-flex align-items-center justify-content-between mb-4"
          >
            <a
              href="/user/dashboard"
              class="d-inline-flex align-items-center text-decoration-none admin-sidebar-brand"
            >
              <img
                src="/images/logo.png"
                alt="Integrated Oasis Logo"
                height="28"
                class="me-2"
              />
              <span class="fw-semibold text-dark small admin-sidebar-brand-text"
                >User</span
              >
            </a>
            <button
              type="button"
              class="btn btn-outline-secondary btn-sm admin-sidebar-toggle"
              id="adminSidebarToggle"
              aria-label="Toggle sidebar width"
            >
              <i class="fa-solid fa-angles-left"></i>
            </button>
          </div>

          <a
            href="/user/dashboard"
            class="nav-link d-flex align-items-center gap-2 mb-3 <%= currentPath.startsWith('/user/dashboard') || currentPath === '/user' ? 'active' : 'text-muted' %>"
          >
            <i class="fa-solid fa-house"></i>
            <span>Dashboard</span>
          </a>
          <a
            href="/user/profile"
            class="nav-link d-flex align-items-center gap-2 mb-3 <%= currentPath.startsWith('/user/profile') ? 'active' : 'text-muted' %>"
          >
            <i class="fa-solid fa-user"></i>
            <span>Profile</span>
          </a>
          <a
            href="/user/courses"
            class="nav-link d-flex align-items-center gap-2 mb-3 <%= currentPath.startsWith('/user/courses') ? 'active' : 'text-muted' %>"
          >
            <i class="fa-solid fa-book-open"></i>
            <span>My Courses</span>
          </a>
          <a
            href="/user/settings"
            class="nav-link d-flex align-items-center gap-2 mb-5 <%= currentPath.startsWith('/user/settings') ? 'active' : 'text-muted' %>"
          >
            <i class="fa-solid fa-gear"></i>
            <span>Settings</span>
          </a>

          <form action="/user/logout" method="post" class="mt-5" id="userLogoutForm">
            <button
              type="button"
              id="userLogoutButton"
              class="btn btn-outline-secondary btn-sm w-100"
            >
              <i class="fa-solid fa-right-from-bracket me-1"></i>
              <span class="admin-sidebar-logout-text">Logout</span>
            </button>
          </form>
        </nav>

      </aside>

      <main class="admin-main container-fluid py-4 px-3 px-md-4">
        <%- body %>
      </main>
    </div>

    <!-- Logout confirmation modal -->
    <div class="modal fade modal-admin-logout" id="userLogoutModal" tabindex="-1" aria-labelledby="userLogoutModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header d-flex align-items-center gap-2">
            <h5 class="modal-title mb-0" id="userLogoutModalLabel">Confirm Logout</h5>
            <button type="button" class="btn-close ms-auto" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body text-center">
            <i class="fa-solid fa-right-from-bracket mb-3" style="color: var(--primary-green); font-size: 2.2rem;"></i>
            <div>Are you sure you want to log out?</div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
            <button type="button" class="btn btn-danger" id="userLogoutConfirmBtn">Logout</button>
          </div>
        </div>
      </div>
    </div>

    <!-- User course details modal (same stacking context as logout modal) -->
    <div class="modal fade" id="userCourseDetailsModal" tabindex="-1" aria-labelledby="userCourseDetailsModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="userCourseDetailsModalLabel">Course Details</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div class="row g-3">
              <div class="col-md-5">
                <img
                  id="detailsCourseImage"
                  src="/images/python.png"
                  alt="Course image"
                  class="img-fluid rounded-3 border w-100"
                  style="max-height: 260px; object-fit: cover;"
                >
              </div>
              <div class="col-md-7">
                <h3 id="detailsCourseTitle" class="h5 mb-2">Course title</h3>
                <p class="small text-muted mb-2">
                  <span class="badge bg-success-subtle text-success me-2" id="detailsCourseLevel">All levels</span>
                  <span id="detailsCourseDuration" class="small">Self-paced</span>
                </p>
                <p id="detailsCoursePrice" class="small mb-2 text-success fw-semibold"></p>
                <p class="small mb-2" id="detailsCourseMeta"></p>
                <p id="detailsCourseDescription" class="small text-muted mb-0"></p>
              </div>
            </div>
          </div>
            <div class="modal-footer">
              <form id="detailsCourseEnrollForm" action="/user/courses/enroll" method="post" class="ms-auto mb-0">
                <input type="hidden" name="courseId" id="detailsCourseIdInput">
                <button type="submit" class="btn btn-success">Enroll</button>
              </form>
            </div>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
    <script src="/js/main.js" defer></script>
  </body>
</html>
